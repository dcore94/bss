<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>Example 3: Data-driven snow effect</title>
		<script type="text/javascript" src="../src/bss-1.1.js"></script>
		<script type="text/javascript">
			var flakeCount = Math.max(100, (Math.random()* 10)|0)
			var flakes = new Array(flakeCount)
			var colors = ["ffffff", "999999", "555555"]
			var H = 480
			var W = 480
			for (var i=0; i < flakes.length; i++){
				flakes[i] = setFlake({}, Math.random() * W, Math.random() * H, Math.random())
			}
			function setFlake(flake, x, y, distance){
				var color = colors[Math.floor(colors.length - (distance * colors.length))]
				flake.x = x; flake.y = y; flake.distance = distance; flake.color = color;
				return flake
			}
			function drawFlake(e, d ,i){
				e.style.color = d.color; 
				e.style.fontSize = 1 + d.distance + "em"; 
				e.style.top = d.y + "px"; 
				e.style.left = d.x + "px"
			}
			var bss_snow = {
				template : "#snow",
				target : "#canvas",
				recurse:[
					{
						in : flakes,
						target : "span",
						apply : drawFlake
					}
				]
			}
			function redraw(){ 
				for(var i=0; i < flakes.length; i++){
					flakes[i].y = flakes[i].y + flakes[i].distance
					if (flakes[i].y > H){
						flakes[i] = setFlake(flakes[i], Math.random() * W, 0, Math.random())
					}
				}
				BSS.reapply(bss_snow); 
				setTimeout(redraw, 30)
			}
			setTimeout(redraw, 30)
		</script>
		<template id="snow">
			<div id="canvas" style="overflow:hidden;position:absolute;width:500px;height:500px;background-color:black;padding:0;border:0;margin:0;">
				<span class="snowflake" style="position:absolute">*</span>
			</div>
		</template>
	</head>
	<body onload="BSS.apply(bss_snow)" style="position:absolute;width:100%;height:100%">
		<h2>Example 3: Data-driven snow effect</h2>
		<h3>Shows replication and applying to visual attributes...</h3>
		<div id="canvas"></div>
		
		<div style="position:absolute;bottom:10%">
			<hr/>
			<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
			<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
		</a><br />
		<span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">BSS Examples</span> by 
		<span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Marco Lettere</span> is licensed under a 
		<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
		</div>
	</body>
</html>
