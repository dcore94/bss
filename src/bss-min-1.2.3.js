var BSS={_get:function(i,n,t,e){return"function"==typeof i?i(n,t,e):i},polyfill:function(){var i="content"in document.createElement("template");if(!i){var n=Array.prototype.slice.call(document.getElementsByTagName("template"));for(var t in n){var e=n[t];for(content=e.children,fragment=document.createDocumentFragment(),e.style.display="none",j=0;node=content[j];j++)fragment.appendChild(node);e.content=fragment}}},commit:function(i){this._bindingCache.commit(i)},clear:function(i){this._bindingCache.clear(i);var n=document.querySelector(this.get(i.target));n.innerHTML=""},reapply:function(i){this._bindingCache.reapply(i)},apply:function(i){if(i.id||(i.id=1e12*Math.random()|0),this._bindingCache.clear(i),i.template){var n=this._get(i.template),t=document.querySelector(n);if(null==t)return void console.error("Template not found",n);var e=document.importNode(t.content,!0);this._bind(i,i,e),this.reapply(i);var r=this._get(i.target),a=document.querySelector(r);if(null==a)return void console.error("Target not found",r);a.parentNode.replaceChild(e,a)}else this._bind(i,i,document),this.reapply(i)},_bind:function(i,n,t,e,r,a){for(var o=t.querySelectorAll(this._get(i.target,t,e,a)),s=0;s<o.length;s++){var c=o.item(s),d=e,l=r;i.inout&&(d=l=this._get(i.inout,c,e,a)),i["in"]&&(d=this._get(i["in"],c,e,a)),i.out&&(l=this._get(i.out,c,e,a));var p=i.recurse?this._get(i.recurse,c,d,a):[],p=p?p instanceof Array?p:[p]:[];if(d instanceof Array){var h=[];for(var s in d)h.push(c.cloneNode(!0));var m=c.parentNode;m.removeChild(c);for(var u in h){var f=h[u];this._bindingCache.addApplyBinding(i,n,f,d,u),l&&this._bindingCache.addCommitBinding(i,n,f,l,u),this._registerEvents(i,f),m.appendChild(f);for(var g in p)this._bind(p[g],n,f,d[u],l?l[u]:null,u)}}else{this._bindingCache.addApplyBinding(i,n,c,d,null),l&&this._bindingCache.addCommitBinding(i,n,c,l,null),this._registerEvents(i,c);for(var g in p)this._bind(p[g],n,c,d,l,a)}}},_registerEvents:function(i,n){for(var t in i)if("on"==t){var e=i[t];for(var r in e){var a=e[r]instanceof Array?e[r]:[e[r]];a.forEach(function(i){n.addEventListener(r,i,!1)})}}else if(0==t.lastIndexOf("on_")){var a=i[t]instanceof Array?i[t]:[i[t]];a.forEach(function(i){n.addEventListener(t.substring(3),i,!1)})}},_bindingCache:{applies:{},commits:{},clear:function(i){this.applies[i.id]=this.applies[i.id]?this.applies[i.id].splice():[],this.commits[i.id]=this.commits[i.id]?this.commits[i.id].splice():[]},addApplyBinding:function(i,n,t,e,r){var a={element:t,index:r,transfer:i.apply?i.apply:function(){},data:r?e[r]:e,container:r?e:null};t.bss_input=a,this.applies[n.id].push(a)},addCommitBinding:function(i,n,t,e,r){var a={element:t,index:r,transfer:i.commit?i.commit:function(){},data:r?e[r]:e,container:r?e:null,remove:r?function(){this.container.splice(this.index,1)}:function(){}};t.bss_output=a,t.bss_binding=a,this.commits[n.id].push(a)},reapply:function(i){this.applies[i.id]&&this.applies[i.id].forEach(function(i){i.transfer(i.element,i.data,i.index)})},commit:function(i){this.commits[i.id]&&this.commits[i.id].forEach(function(i){i.transfer(i.element,i.data,i.index)})}}};
